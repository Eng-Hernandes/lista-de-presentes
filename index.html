<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Escolha um Presente</title>
  <script>
    function registrarEscolha(nome, itemEscolhido) {
      if (!nome || !itemEscolhido) {
        alert('Por favor, preencha todos os campos.');
        return;
      }

      // Substitua pelo link do seu Google Apps Script
      var linkScript = "https://script.google.com/macros/s/AKfycbyIcSSgOO_wIb-jScu5C15XXWxznKWXWelm6NQAMzITsfu5R30QvzRbVmAM7bac716N/exec";
      
      // Chama a função no Google Apps Script para registrar a escolha
      fetch(linkScript + `?nome=${nome}&itemEscolhido=${itemEscolhido}`)
        .then(response => response.json())
        .then(data => {
          if (data.status === 'erro') {
            alert(data.mensagem); // Exibe o popup se o item já foi escolhido
          } else {
            alert(data.mensagem); // Sucesso
            // Remover o item da lista (desabilitando o botão de escolha)
            document.getElementById(itemEscolhido).disabled = true;
          }
        })
        .catch(error => {
          alert('Erro ao registrar escolha. Tente novamente.');
        });
    }
  </script>
</head>
<body>
  <h2>Escolha um Presente</h2>
  
  <label for="nome">Seu nome:</label>
  <input type="text" id="nome" name="nome"><br><br>

  <ul>
    <li>
      <span>Vaporizador e Ferro de Passar Roupa</span>
      <a href="https://mercadolivre.com/sec/2ee4nJS" target="_blank">Comprar</a>
      <button id="Vaporizador" onclick="registrarEscolha(document.getElementById('nome').value, 'Vaporizador e Ferro de Passar Roupa')">Escolher</button>
    </li>
    <li>
      <span>Ventilador De Coluna</span>
      <a href="https://mercadolivre.com/sec/1ZAdm5x" target="_blank">Comprar</a>
      <button id="Ventilador" onclick="registrarEscolha(document.getElementById('nome').value, 'Ventilador De Coluna')">Escolher</button>
    </li>
    <li>
      <span>Jogo De Ferramentas</span>
      <a href="https://mercadolivre.com/sec/1hoSkKy" target="_blank">Comprar</a>
      <button id="JogoDeFerramentas" onclick="registrarEscolha(document.getElementById('nome').value, 'Jogo De Ferramentas')">Escolher</button>
    </li>
    <li>
      <span>Jogo De Panelas</span>
      <a href="https://mercadolivre.com/sec/2uJVwKA" target="_blank">Comprar</a>
      <button id="JogoDePanelas" onclick="registrarEscolha(document.getElementById('nome').value, 'Jogo De Panelas')">Escolher</button>
    </li>
    <li>
      <span>Cafeteira portátil</span>
      <a href="https://mercadolivre.com/sec/1i7Vb7f" target="_blank">Comprar</a>
      <button id="CafeteiraPortatil" onclick="registrarEscolha(document.getElementById('nome').value, 'Cafeteira portátil')">Escolher</button>
    </li>
    <li>
      <span>Aspirador De Pó e Água Wap</span>
      <a href="https://mercadolivre.com/sec/2x2Jm1t" target="_blank">Comprar</a>
      <button id="Aspirador" onclick="registrarEscolha(document.getElementById('nome').value, 'Aspirador De Pó e Água Wap')">Escolher</button>
    </li>
    <li>
      <span>Kit Churrasco</span>
      <a href="https://mercadolivre.com/sec/1stjHiJ" target="_blank">Comprar</a>
      <button id="KitChurrasco" onclick="registrarEscolha(document.getElementById('nome').value, 'Kit Churrasco')">Escolher</button>
    </li>
    <li>
      <span>Máquina Golden Waffle</span>
      <a href="https://mercadolivre.com/sec/1CfJRZT" target="_blank">Comprar</a>
      <button id="MaquinaGoldenWaffle" onclick="registrarEscolha(document.getElementById('nome').value, 'Máquina Golden Waffle')">Escolher</button>
    </li>
  </ul>
</body>
</html>
