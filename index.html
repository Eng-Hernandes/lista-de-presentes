<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Escolha um Presente</title>
  <script>
    function registrarEscolha() {
      var nome = document.getElementById('nome').value;
      var itemEscolhido = document.getElementById('presentes').value;

      if (!nome || !itemEscolhido) {
        alert('Por favor, preencha todos os campos.');
        return;
      }

      // Substitua pelo link do seu Google Apps Script
      var linkScript = "https://script.google.com/macros/s/AKfycbxYgC-vUZw2sfUMyttIY-qkE0fUcj2FzAXAgGPMo7j605MnQpu_SKqbTxX2wwLAQXdS/exec";
      
      // Chama a função no Google Apps Script para registrar a escolha
      fetch(linkScript + `?nome=${nome}&itemEscolhido=${itemEscolhido}`)
        .then(response => response.json())
        .then(data => {
          if (data.status === 'erro') {
            alert(data.mensagem); // Exibe o popup se o item já foi escolhido
          } else {
            alert(data.mensagem); // Sucesso
            // Remover o item da lista (opcional: você pode fazer isso no Apps Script)
            document.getElementById('presentes').options[document.getElementById('presentes').selectedIndex].disabled = true;
          }
        })
        .catch(error => {
          alert('Erro ao registrar escolha. Tente novamente.');
        });
    }
  </script>
</head>
<body>
  <h2>Escolha um Presente</h2>
  
  <label for="nome">Seu nome:</label>
  <input type="text" id="nome" name="nome"><br><br>
  
  <label for="presentes">Escolha um presente:</label>
  <select id="presentes">
    <option value="Vaporizador e Ferro de Passar Roupa">Vaporizador e Ferro de Passar Roupa</option>
    <option value="Ventilador De Coluna">Ventilador De Coluna</option>
    <option value="Jogo De Ferramentas">Jogo De Ferramentas</option>
    <option value="Jogo De Panelas">Jogo De Panelas</option>
    <option value="Cafeteira portátil">Cafeteira portátil</option>
    <option value="Aspirador De Pó e Água Wap">Aspirador De Pó e Água Wap</option>
    <option value="Kit Churrasco">Kit Churrasco</option>
    <option value="Máquina Golden Waffle">Máquina Golden Waffle</option>
  </select><br><br>
  
  <button onclick="registrarEscolha()">Escolher</button>
</body>
</html>
